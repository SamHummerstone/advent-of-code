Oh God this one is messy, I'm definitely not doing this the right way. 

I've completed the first part with some spaghetti but backed myself into a corner for part 2.

This should probably have some refactoring done first, the tests are helpful but even they are a bit copy-paste heavy.

Whilst the tests are passing, I should probably refactor them now, and then refactor the actual code down a bit, then I can try and introduce the new functionality. It is VERY tempting to brute force my way through part 2 so I don't have to look at this code again, but I don't think that's in the spirit of things.

Eventually I would like to use some concurrency mechanisms for these tasks, but I think I'll need to improve my code quality first, as it will add a new dimension of complexity and debugging that I'm probably not ready for.